library(openintro)
data(COL)

d = read.csv("sleep.csv")
sleep = d$sleep[!is.na(d$sleep)]

n = length(sleep)
m = mean(sleep)
s = sd(sleep)

# sleep-hist
pdf("sleep-hist.pdf", height = 5, width = 8)
par(mar = c(2.5,2.5,0,0), las = 1)
hist(sleep, col = COL[1], main = "", xlab = "", ylab = "", axes = FALSE)
axis(1, cex.axis = 1.5)
axis(2, at = seq(0,80,20), cex.axis = 1.5)
text(x = 8, y = 55, paste("mean = ",round(m,2)), cex = 1.5)
text(x = 8, y = 50, paste("sd = ",round(s,2)), cex = 1.5)
dev.off()

# sleep-hist-sd1
pdf("sleep-hist-sd1.pdf", height = 5, width = 8)
par(mar = c(2.5,2.5,0,0), las = 1)
hist(sleep, col = COL[1], main = "", xlab = "", ylab = "", axes = FALSE)
axis(1, cex.axis = 1.5)
axis(2, at = seq(0,80,20), cex.axis = 1.5)
abline(v = m)
rect(m-s, -5, m+s, 500, col=COL[6,4], border='#00000000')
text(x = m, y = 30, paste(round(sum((sleep >= m - s) & (sleep <= m + s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-s,m-0.5),y = c(30,30), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+s),y = c(30,30), col = COL[4], lwd = 2)
dev.off()


# sleep-hist-sd2
pdf("sleep-hist-sd2.pdf", height = 5, width = 8)
par(mar = c(2.5,2.5,0,0), las = 1)
hist(sleep, col = COL[1], main = "", xlab = "", ylab = "", axes = FALSE)
axis(1, cex.axis = 1.5)
axis(2, at = seq(0,80,20), cex.axis = 1.5)
abline(v = m)
rect(m-s, -5, m+s, 500, col=COL[6,4], border='#00000000')
rect(m-2*s, -5, m+2*s, 500, col=COL[6,3], border='#00000000')
text(x = m, y = 30, paste(round(sum((sleep >= m - s) & (sleep <= m + s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-s,m-0.5),y = c(30,30), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+s),y = c(30,30), col = COL[4], lwd = 2)
text(x = m, y = 50, paste(round(sum((sleep >= m - 2*s) & (sleep <= m + 2*s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-2*s,m-0.5),y = c(50,50), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+2*s),y = c(50,50), col = COL[4], lwd = 2)
dev.off()

# sleep-hist-sd3
pdf("sleep-hist-sd3.pdf", height = 5, width = 8)
par(mar = c(2.5,2.5,0,0), las = 1)
hist(sleep, col = COL[1], main = "", xlab = "", ylab = "", axes = FALSE)
axis(1, cex.axis = 1.5)
axis(2, at = seq(0,80,20), cex.axis = 1.5)
abline(v = m)
rect(m-s, -5, m+s, 500, col=COL[6,4], border='#00000000')
rect(m-2*s, -5, m+2*s, 500, col=COL[6,3], border='#00000000')
rect(m-3*s, -5, m+3*s, 500, col=COL[6,2], border='#00000000')
text(x = m, y = 30, paste(round(sum((sleep >= m - s) & (sleep <= m + s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-s,m-0.5),y = c(30,30), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+s),y = c(30,30), col = COL[4], lwd = 2)
text(x = m, y = 50, paste(round(sum((sleep >= m - 2*s) & (sleep <= m + 2*s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-2*s,m-0.5),y = c(50,50), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+2*s),y = c(50,50), col = COL[4], lwd = 2)
text(x = m, y = 70, paste(round(sum((sleep >= m - 3*s) & (sleep <= m + 3*s)) / n,2)*100,"%"), col = COL[4], cex = 1.5)
lines(x = c(m-3*s,m-0.5),y = c(70,70), col = COL[4], lwd = 2)
lines(x = c(m+0.5,m+3*s),y = c(70,70), col = COL[4], lwd = 2)
dev.off()