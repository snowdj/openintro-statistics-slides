data(COL)
pdf("app_z.pdf", height = 3.5, width = 7)
par(mar=c(2,0,0,0))
normTail(m = 8, s = 0.5, U = 9.7, axes = FALSE, col = "white")
axis(1, at = c(8-3*0.5, 8, 9.7, 8+3*0.5),
labels = c(NA, expression(paste(mu, " = 8")),
expression(paste(bar(x), " = 9.7")), NA), cex.axis = 1.5)
dev.off()
pdf("app_pval_gr.pdf", height = 3.5, width = 7)
par(mar=c(2,0,0,0))
normTail(m = 8, s = 0.5, U = 9.7, axes = FALSE, col = COL[1])
axis(1, at = c(8-3*0.5, 8, 9.7, 8+3*0.5),
labels = c(NA, expression(paste(mu, " = 8")),
expression(paste(bar(x), " = 9.7")), NA), cex.axis = 1.5)
dev.off()
1-.0202*2
(1.96 * 18 / 4)^2
(2.05 * 18 / 4)^2
setwd("~/Desktop/Open Intro/OISlides_Draft/Chp 7/figures/poverty")
COL
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
poverty = read.table("poverty.txt", h = T, sep = "\t")
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[1])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = "red")
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = "darkgreen")
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = "darkgreen")
abline(lm_pov_grad, col = COL[1], lwd = 3)
COL <- c('#55000088','#225588')
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[1])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = "red")
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = "darkgreen")
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = "darkgreen")
abline(lm_pov_grad, col = COL[1], lwd = 3)
dev.off()
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[1])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = "red")
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = "darkgreen")
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = "darkgreen")
abline(lm_pov_grad, col = COL[1], lwd = 3)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,16), hlCol = c("red","darkgreen"), hlPch = c(15,8), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,20), hlCol = c("red","darkgreen"), hlPch = c(15,8), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
poverty = read.table("poverty.txt", h = T, sep = "\t")
COL <- c('#55000088','#225588')
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,20), hlCol = c("red","darkgreen"), hlPch = c(15,8), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
View(poverty)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,2), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,3), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,4), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,5), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,6), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,7), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,8), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,9), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,10), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,11), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,12), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,13), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,14), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,15), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,16), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
pdf("poverty_hsgrad_resplot.pdf", height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[1], lwd = 2, xAxis = 4)
dev.off()
setwd("~/Desktop/Open Intro/OI Slides/Chp 7/7-1_linefit_res_corr/figures/poverty")
poverty = read.table("poverty.txt", h = T, sep = "\t")
library(openintro)
data(COL)
COL
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[1], lwd = 3)
abline(lm_pov_grad, col = COL[3], lwd = 3)
abline(lm_pov_grad, col = COL[2], lwd = 3)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 6, "intercept", cex = 1.5, col = "blue")
text(y = lm_pov_grad$coefficient[1]+3, x = 6, "intercept", cex = 1.5, col = COL[1])
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
pdf("poverty_hsgrad.pdf", height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
dev.off()
pdf("poverty_hsgrad.pdf", height = 5, width = 4)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
dev.off()
pdf("poverty_hsgrad.pdf", height = 5.5, width = 6)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
dev.off()
pdf("poverty_hsgrad_line_wide.pdf", 10, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
dev.off()
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
pdf("poverty_hsgrad_line.pdf", height = 5.5, width = 6)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
dev.off()
plot(poverty$Poverty ~ poverty$PercentFemaleHouseholderNoHusbandPresent, ylab = "% in poverty", xlab = "% female householder, no husband present", pch=19, col=COL[1]])
View(poverty)
plot(poverty$Poverty ~ poverty$PercentFemaleHouseholderNoHusbandPresent, ylab = "% in poverty", xlab = "% female householder, no husband present", pch=19, col=COL[1])
plot(poverty$Poverty ~ poverty$PercentFemaleHouseholderNoHusbandPresent, ylab = "% in poverty", xlab = "% female householder, no husband present", pch=19, col=COL[1,2])
# scatterplot
pdf("poverty_hsgrad.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
dev.off()
# scatterplot, with line
pdf("poverty_hsgrad_line.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
dev.off()
# scatterplot, %poverty vs.%no husband
pdf("poverty_nohusband.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$PercentFemaleHouseholderNoHusbandPresent, ylab = "% in poverty", xlab = "% female householder, no husband present", pch=19, col=COL[1,2])
dev.off()
setwd("~/Desktop/Open Intro/OI Slides/Chp 7/7-1_linefit_res_corr/figures/cor")
set.seed(179)
# 4 scatterplots
x = seq(0,10,0.1)
yNonLin = (x-3)^2 - 4 + rnorm(length(x), mean = 0, sd = 1)
yPosLinStrong = 3*x + 10 + rnorm(length(x), mean = 0, sd = 2)
yPosLinWeak = 3*x + 10 + rnorm(length(x), mean = 0, sd = 20)
yNegLinWeak = -3*x + 10 + rnorm(length(x), mean = 0, sd = 5)
pdf("cor.pdf", 5.5, 4.3)
par(mar=c(2,1,1,1), las=1, mgp=c(0.5,0.7,0), mfrow = c(2,2), cex.lab = 1.5, cex.axis = 1.5)
plot(yNonLin ~ x, ylab = "", xlab = "(a)", pch=19, col=COL[1,2], axes = FALSE)
box()
plot(yPosLinStrong ~ x, ylab = "", xlab = "(b)", pch=19, col=COL[1,2], axes = FALSE)
box()
plot(yPosLinWeak ~ x, ylab = "", xlab = "(c)", pch=19, col=COL[1,2], axes = FALSE)
box()
plot(yNegLinWeak ~ x, ylab = "", xlab = "(d)", pch=19, col=COL[1,2], axes = FALSE)
box()
dev.off()
cor(yNonLin,x)
cor(yPosLinStrong,x)
cor(yPosLinWeak,x)
cor(yNegLinWeak,x)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[2], lwd = 3, lty = 1)
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[4], lwd = 3, lty = 1)
y1 = lm(poverty$Poverty ~ poverty$Graduates)$coefficients[1] + 2 + (1.1 * lm(poverty$Poverty ~ poverty$Graduates)$coefficients[2]) * poverty$Graduates
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = "green", lty = 2)
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = COL[2], lty = 2)
abline(h = 14, lwd = 3, col = "blue", lty = 3)
abline(h = 14, lwd = 3, col = COL[1], lty = 3)
y2 = 114 - (12/10) * seq(70,100,1)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = 5, lty = 4)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = COL[3], lty = 4)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[4], lwd = 3, lty = 1)
y1 = lm(poverty$Poverty ~ poverty$Graduates)$coefficients[1] + 2 + (1.1 * lm(poverty$Poverty ~ poverty$Graduates)$coefficients[2]) * poverty$Graduates
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = COL[2], lty = 2)
abline(h = 14, lwd = 3, col = COL[1], lty = 3)
y2 = 114 - (12/10) * seq(70,100,1)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = COL[3], lty = 4)
abline(h = 14, lwd = 3, col = COL[1], lty = 5)
abline(h = 14, lwd = 3, col = COL[5], lty = 3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[4], lwd = 3, lty = 1)
y1 = lm(poverty$Poverty ~ poverty$Graduates)$coefficients[1] + 2 + (1.1 * lm(poverty$Poverty ~ poverty$Graduates)$coefficients[2]) * poverty$Graduates
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = COL[2], lty = 2)
abline(h = 14, lwd = 3, col = COL[5], lty = 3)
y2 = 114 - (12/10) * seq(70,100,1)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = COL[3], lty = 4)
legend("topright", inset = 0.05, c("(a)","(b)","(c)", "(d)"),
col = c(COL[4],COL[2],COL[5],COL[3]), lwd = 3, lty = c(1,2,3,4))
pdf("poverty_hsgrad_manylines.pdf", 5.5, 5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[4], lwd = 3, lty = 1)
y1 = lm(poverty$Poverty ~ poverty$Graduates)$coefficients[1] + 2 + (1.1 * lm(poverty$Poverty ~ poverty$Graduates)$coefficients[2]) * poverty$Graduates
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = COL[2], lty = 2)
abline(h = 14, lwd = 3, col = COL[5], lty = 3)
y2 = 114 - (12/10) * seq(70,100,1)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = COL[3], lty = 4)
legend("topright", inset = 0.05, c("(a)","(b)","(c)", "(d)"),
col = c(COL[4],COL[2],COL[5],COL[3]), lwd = 3, lty = c(1,2,3,4))
dev.off()
setwd("~/Desktop/Open Intro/OI Slides/Chp 7/7-2_least_square_reg/figures/poverty")
pdf("poverty_hsgrad_manylines.pdf", 5.5, 5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
abline(lm(poverty$Poverty ~ poverty$Graduates), col = COL[4], lwd = 3, lty = 1)
y1 = lm(poverty$Poverty ~ poverty$Graduates)$coefficients[1] + 2 + (1.1 * lm(poverty$Poverty ~ poverty$Graduates)$coefficients[2]) * poverty$Graduates
abline(lm(y1 ~ poverty$Graduates), lwd = 3, col = COL[2], lty = 2)
abline(h = 14, lwd = 3, col = COL[5], lty = 3)
y2 = 114 - (12/10) * seq(70,100,1)
abline(lm(y2 ~ seq(70,100,1)), lwd = 3, col = COL[3], lty = 4)
legend("topright", inset = 0.05, c("(a)","(b)","(c)", "(d)"),
col = c(COL[4],COL[2],COL[5],COL[3]), lwd = 3, lty = c(1,2,3,4))
dev.off()
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in 1:length(pred)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[1])
}
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
for(i in 1:length(pred)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
}
abline(lm_pov_grad, col = COL[4], lwd = 3)
pdf("poverty_hsgrad_res.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in 1:length(pred)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
}
abline(lm_pov_grad, col = COL[4], lwd = 3)
dev.off()
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[1])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = "red")
}
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = "red")
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = "darkgreen")
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = "darkgreen")
abline(lm_pov_grad, col = COL[4], lwd = 3)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = COL[4])
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = COL[2])
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = COL[2])
abline(lm_pov_grad, col = COL[4], lwd = 3)
pdf("poverty_hsgrad_res_text.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
pred = predict(lm_pov_grad)
x = poverty$Graduates
for(i in c(9,40)){
lines(c(x[i],x[i]), c(poverty$Poverty[i],pred[i]), col = COL[2])
text(x[i]+0.5, poverty$Poverty[i], "y", cex = 1.5, col = "blue")
text(x[i]+1.2, mean(c(poverty$Poverty[i],pred[i])), as.character(round(poverty$Poverty[i] - pred[i],2)), cex = 1.5, col = "orange")
text(x[i]-0.5, pred[i], expression(hat(y)), cex = 1.5, col = COL[4])
}
text(x[9], poverty$Poverty[9] + 0.5, "DC", col = COL[2])
text(x[40], poverty$Poverty[40] - 0.5, "RI", col = COL[2])
abline(lm_pov_grad, col = COL[4], lwd = 3)
dev.off()
# scatterplot
pdf("poverty_hsgrad.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
dev.off()
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
pdf("poverty_hsgrad_line_wide.pdf", 10, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2], xlim = c(0,100), ylim = c(0,70))
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
abline(v = 0)
text(y = lm_pov_grad$coefficient[1]+3, x = 7, "intercept", cex = 1.5, col = COL[1])
dev.off()
# scatterplot, with line
pdf("poverty_hsgrad_line.pdf", 5.5, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
dev.off()
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
lines(x = c(82,82), y = c(0,64.781-0.6212*82), lty = 3)
lines(x = c(0,82), y = c(64.781-0.6212*82,64.781-0.6212*82), lty = 3)
pdf("poverty_hsgrad_pred.pdf", 10, 4.3)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.5, cex.axis = 1.5)
plot(poverty$Poverty ~ poverty$Graduates, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
lm_pov_grad = lm(poverty$Poverty ~ poverty$Graduates)
abline(lm_pov_grad, col = COL[4], lwd = 3)
lines(x = c(82,82), y = c(0,64.781-0.6212*82), lty = 3)
lines(x = c(0,82), y = c(64.781-0.6212*82,64.781-0.6212*82), lty = 3)
dev.off()
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
?lmPlot
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), col = COL[1], ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), col = COL[1,2], ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
pdf("poverty_hsgrad_resplot.pdf", height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c("red","darkgreen"), hlPch = c(15,17), col = COL[1,2], ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
dev.off()
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c(COL[4],COL[2]), hlPch = c(15,17), col = COL[1,2], ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
pdf("poverty_hsgrad_resplot.pdf", height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x = poverty$Graduates, y = poverty$Poverty, highlight = c(9,40), hlCol = c(COL[4],COL[2]), hlPch = c(15,17), col = COL[1,2], ylab = "% in poverty", xlab = "% HS grad", lCol = COL[4], lwd = 2, xAxis = 4)
dev.off()
histPlot(lm_pov_grad$residuals, col = COL[1], border = COL[2], xlab = "residuals")
qqnorm(lm_pov_grad$residuals, pch = 19, col = COL[1,2])
qqline(lm_pov_grad$residuals, pch = 19, col = COL[1])
par(mfrow=c(1,2))
histPlot(lm_pov_grad$residuals, col = COL[1], border = COL[2], xlab = "residuals")
qqnorm(lm_pov_grad$residuals, pch = 19, col = COL[1,2])
qqline(lm_pov_grad$residuals, pch = 19, col = COL[1])
pdf("normal_res.pdf", 10, 4.3)
par(mfrow=c(1,2))
histPlot(lm_pov_grad$residuals, col = COL[1], border = COL[2], xlab = "residuals")
qqnorm(lm_pov_grad$residuals, pch = 19, col = COL[1,2])
qqline(lm_pov_grad$residuals, pch = 19, col = COL[1])
dev.off()
pdf("normal_res.pdf", 10, 4.3)
par(mfrow=c(1,2))
histPlot(lm_pov_grad$residuals, col = COL[1], xlab = "residuals")
qqnorm(lm_pov_grad$residuals, pch = 19, col = COL[1,2])
qqline(lm_pov_grad$residuals, pch = 19, col = COL[1])
dev.off()
layout(matrix(1:2, 2), c(1,1), c(2,1))
par(mar=c(4,4,1,1))
plot(x = poverty$Graduates, y = poverty$Poverty, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[2])
layout(matrix(1:2, 2), c(1,1), c(2,1))
par(mar=c(4,4,1,1))
plot(x = poverty$Graduates, y = poverty$Poverty, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
makeTube(x = poverty$Graduates, y = poverty$Poverty)
plot(x = poverty$Graduates, y = lm_pov_grad$residuals, pch=19, col=COL[1,2], ylab = "", xlab = "", axes = FALSE, ylim = c(-5.5,5.5))
makeTube(x = poverty$Graduates, y = lm_pov_grad$residuals, addLine = FALSE)
axis(1, at = c(80,90,95))
axis(2, at = c(-4, 0, 4))
box()
abline(h = 0, lty = 2)
pdf("poverty_hsgrad_tube.pdf", height = 6, width = 5.5)
layout(matrix(1:2, 2), c(1,1), c(2,1))
par(mar=c(4,4,1,1))
plot(x = poverty$Graduates, y = poverty$Poverty, ylab = "% in poverty", xlab = "% HS grad", pch=19, col=COL[1,2])
makeTube(x = poverty$Graduates, y = poverty$Poverty)
plot(x = poverty$Graduates, y = lm_pov_grad$residuals, pch=19, col=COL[1,2], ylab = "", xlab = "", axes = FALSE, ylim = c(-5.5,5.5))
makeTube(x = poverty$Graduates, y = lm_pov_grad$residuals, addLine = FALSE)
axis(1, at = c(80,90,95))
axis(2, at = c(-4, 0, 4))
box()
abline(h = 0, lty = 2)
dev.off()
library(openintro)
data(COL)
setwd("~/Desktop/Open Intro/OI Slides/Chp 7/7-3_outliers/figures/outlierPlots")
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
for(i in 1:3){
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
#temp = lm(y~x)
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
pdf(paste("out",i,".pdf",sep=""), height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3)
#abline(temp, lty = 3)
dev.off()
}
for(i in 4:6){
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
pdf(paste("out",i,".pdf",sep=""), height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3)
dev.off()
}
i = 5
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
pdf(paste("out5-1.pdf",sep=""), height = 6, width = 5.5)
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x[1:70], y[1:70], col = COL[1,2], lCol = COL[4], lwd = 3, xlim = range(x), ylim = range(y))
dev.off()
library(faraway)
library(openintro)
data(COL)
data(star)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[1], lwd = 3)
abline(lm(light~temp, data = star), col = "darkgreen", lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c("darkgreen",COL[1]))
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[4],COL[2]))
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]))
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]))
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]))
COL
library(faraway)
library(openintro)
data(COL)
data(star)
pdf("star.pdf", height = 4.3, width = 5.5)
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]))
dev.off()
setwd("~/Desktop/Open Intro/OI Slides/Chp 7/7-4_inf_lin_reg/figures/twins")
library(faraway)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 1.25, las = 1, cex.axis = 1.5, cex.lab = 1.5)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.5)
dev.off()
pdf("twins_IQ.pdf", height = 4, width = 6)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 1.25, las = 1, cex.axis = 1.5, cex.lab = 1.5)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.5)
dev.off()
